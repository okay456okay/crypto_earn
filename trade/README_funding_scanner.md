# 多交易所资金费率扫描器

## 功能概述

这是一个专业的多交易所资金费率扫描工具，用于筛选符合特定条件的合约交易对，帮助发现资金费率套利机会。

## 筛选条件

1. **资金费率**: 小于 -0.5%
2. **结算时间**: 下次资金费率结算时间必须为下一个整点

### 示例说明

假设当前时间为 `2025-06-07 09:30:00`：

✅ **符合条件**:
- 交易对: ACTUSDT
- 下次结算时间: `2025-06-07 10:00:00` (下个整点)
- 资金费率: -1.3% (< -0.5%)

❌ **不符合条件**:
- 交易对: ACTUSDT  
- 下次结算时间: `2025-06-07 12:00:00` (不是下个整点)
- 资金费率: -1.0% (虽然满足费率条件，但时间不对)

## 支持的交易所

- ✅ **Binance** (币安)
- ✅ **Bybit** (必贝)
- ✅ **Bitget** (比特护)
- ✅ **Gate.io** (芝麻开门)

## 安装依赖

```bash
pip install ccxt
```

## 配置设置

在项目根目录的 `config.py` 文件中配置API密钥：

```python
# Binance API
binance_api_key = "your_binance_api_key"
binance_api_secret = "your_binance_api_secret"

# Bybit API
bybit_api_key = "your_bybit_api_key"
bybit_api_secret = "your_bybit_api_secret"

# Bitget API
bitget_api_key = "your_bitget_api_key"
bitget_api_secret = "your_bitget_api_secret"

# Gate.io API
gateio_api_key = "your_gateio_api_key"
gateio_api_secret = "your_gateio_api_secret"
```

## 使用方法

### 基本用法

```bash
# 扫描所有交易所
python funding_rate_scanner.py
```

### 输出示例

```
================================================================================
开始扫描所有交易所的资金费率
筛选条件: 资金费率 < -0.5% 且下次结算时间为下个整点
================================================================================

BINANCE 交易所连接成功
BYBIT 交易所连接成功
BITGET 交易所连接成功
GATEIO 交易所连接成功

开始扫描 BINANCE 交易所...
BINANCE 找到 245 个合约交易对
✅ BINANCE ACTUSDT: -0.7500% @ 2025-06-07 10:00:00
✅ BINANCE ETHUSDT: -0.6200% @ 2025-06-07 10:00:00

开始扫描 BYBIT 交易所...
BYBIT 找到 312 个合约交易对
✅ BYBIT BTCUSDT: -0.5500% @ 2025-06-07 10:00:00

================================================================================
扫描结果汇总
================================================================================
✅ 找到 3 个符合条件的交易对:

序号 交易所   交易对          资金费率   下次结算时间
----------------------------------------------------------------------
1    BINANCE  ACTUSDT        -0.7500%  2025-06-07 10:00:00
2    BINANCE  ETHUSDT        -0.6200%  2025-06-07 10:00:00
3    BYBIT    BTCUSDT        -0.5500%  2025-06-07 10:00:00
----------------------------------------------------------------------
总计: 3 个机会

各交易所统计:
  BINANCE: 2 个机会
  BYBIT: 1 个机会

扫描完成，耗时: 45.3 秒
```

## 功能特性

### 🚀 **高效扫描**
- 并发扫描多个交易所
- 智能API限制处理
- 实时进度显示

### 🎯 **精准筛选**
- 严格的时间条件检查（下个整点±5分钟误差）
- 可配置的资金费率阈值
- 自动排序（按资金费率从低到高）

### 📊 **详细报告**
- 完整的扫描结果表格
- 各交易所统计信息
- 扫描耗时统计

### 🛡️ **错误处理**
- 完善的异常处理机制
- API限制自动重试
- 连接失败自动跳过

## 日志文件

扫描过程会自动创建日志文件：
- 位置: `trade/logs/funding_rate_scanner_YYYYMMDD.log`
- 包含详细的扫描记录和错误信息

## 注意事项

### API要求
- 需要各交易所的API密钥（只读权限即可）
- 建议设置IP白名单提高安全性
- 确保API密钥有访问合约数据的权限

### 性能优化
- 脚本会自动处理API限制
- 每100个交易对会暂停1秒
- 并发扫描提高效率

### 时间精度
- 允许5分钟的时间误差
- 基于本地时间进行计算
- 建议在整点前几分钟运行

## 故障排除

### 常见问题

1. **API连接失败**
   - 检查API密钥是否正确
   - 确认网络连接和代理设置
   - 验证API权限是否足够

2. **找不到符合条件的交易对**
   - 检查当前时间是否接近整点
   - 确认资金费率阈值设置是否合理
   - 查看日志了解详细扫描过程

3. **扫描速度慢**
   - API限制是正常现象
   - 可以调整扫描间隔参数
   - 确保网络连接稳定

## 免责声明

本工具仅供信息查询和研究目的使用。资金费率会实时变化，请在实际交易前再次确认最新数据。

**投资有风险，决策需谨慎！** 